---
title: 浏览器都做了什么
categories:
  - 面试题
tags:
  - HTTP
date: 2023-04-08 18:23:08
updated:
---

# 一个页面从输入 URL 到页面加载显示完成，这个过程中都发生了什么？

## 1、解析 URL

- 对 URL 进行解析 分析传输协议金和资源路径
- 协议或主机名是否合法
  - 是 检查 是否存在非法字符 并对其进行转义
  - 否 内容传输给搜索引擎

## 2、缓存判断

- 浏览器是否存在资源缓存 是有有效
  - 是 直接使用
  - 否 向服务器发起新的请求

## 3、DNS 解析

- 获取 URL 中域名的 IP 地址
- 用户向本地 DNS 服务器发起请求属于递归请求，本地 DNS 服务器向各级域名服务器发起请求属于迭代请求
- 检查 本地 DNS 服务器 是否存在该域名的 IP 地址的缓存
  - 是 直接使用
  - 否 请求跟域名服务器 => 获得 负责的顶级域名服务器地址 => 请求负责的顶级域名服务器 => 获得域名的 IP 地址

## 4、获取 MAC 地址

## 5、TCP 三次握手

- 确认客户端与服务端的接受与发送能量
- 客户端发送 SYN 连接请求报文段和一个随机序号
- 服务端确认连接请求 并先客户端发送一个随机序号
- 客户端进入连接建立的状态，并向服务器发送一个 ACK 确认报文段
- 服务端接收确认后进入连接建立转态
- 双方的连接建立完成

## 6、HTTPS 握手

- 如果用的 HTTPS 协议 在通信前还存在 TLS 的第四次捂手过程
- 客户端发送 协议本部好 随机数 加密方法
- 服务端确认加密方法后发送 随机数 数字证书
- 客户端确认证书后发送 随机数并加密 全部内容的 hash
- 服务端解密随机数后发生 全部内容的 hash
- 此时双方都有 3 个随机数
- 加密生成秘钥

## 7、发送 HTTP 请求

- 服务端处理请求，返回 HTTP 报文

## 8、页面渲染

- 解析 HTML 文件构建 DOM 树
- 解析 CSS 文件构建 CSSOM 树
- 如果遇到 script 标签判断是否同步加载还是异步加载
- DOM 树与 CSSOM 树合成渲染树进行布局
- 布局完成后使用浏览器的 UI 接口对页面进行绘制

## 9、TCP 第四次握手

- 最后一步是 TCP 端口连接的第四次握手过程
